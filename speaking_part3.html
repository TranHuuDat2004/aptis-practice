<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speaking - Part 3</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="icon" href="img/favicon.png" type="image/x-icon">
</head>

<body>
    <header id="header-placeholder"></header>
    <div class="content-pusher">
        <div class="container">
            <div class="page-intro">
                <h1>Speaking - Part 3</h1>
                <p>So s√°nh tranh v√† tr·∫£ l·ªùi c√¢u h·ªèi</p>
            </div>
            <div class="explanation-box">
                <h3>üí° Ph∆∞∆°ng ph√°p luy·ªán t·∫≠p hi·ªáu qu·∫£</h3>
                <p>Trang web n√†y m√¥ ph·ªèng ƒëi·ªÅu ki·ªán thi b·∫±ng c√°ch cung c·∫•p c√¢u h·ªèi v√† ƒë·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c. V√¨ tr√¨nh duy·ªát
                    ch∆∞a h·ªó tr·ª£ ghi √¢m tr·ª±c ti·∫øp, h√£y l√†m theo c√°c b∆∞·ªõc sau:</p>
                <ul>
                    <li><strong>B∆∞·ªõc 1:</strong> M·ªü ·ª©ng d·ª•ng ghi √¢m tr√™n ƒëi·ªán tho·∫°i c·ªßa b·∫°n.</li>
                    <li><strong>B∆∞·ªõc 2:</strong> Tr√™n trang web, nh·∫•n n√∫t "‚ñ∂Ô∏è B·∫Øt ƒë·∫ßu tr·∫£ l·ªùi" v√† b·∫Øt ƒë·∫ßu ghi √¢m tr√™n
                        ƒëi·ªán tho·∫°i c√πng l√∫c.</li>
                    <li><strong>B∆∞·ªõc 3:</strong> Tr·∫£ l·ªùi c√¢u h·ªèi trong kho·∫£ng th·ªùi gian cho ph√©p. ƒê·ªìng h·ªì s·∫Ω gi√∫p b·∫°n
                        ki·ªÉm so√°t ƒë·ªô d√†i c√¢u tr·∫£ l·ªùi.</li>
                    <li><strong>B∆∞·ªõc 4:</strong> Sau khi ho√†n th√†nh, b·∫°n c√≥ th·ªÉ t·∫£i file ghi √¢m (MP3) l√™n c√°c c√¥ng c·ª• AI
                        nh∆∞ Google Studio, ChatGPT-4o, ho·∫∑c c√°c d·ªãch v·ª• s·ª≠a b√†i n√≥i chuy√™n d·ª•ng ƒë·ªÉ nh·∫≠n feedback.</li>
                </ul>
            </div>

            <!-- C·∫®M NANG H∆Ø·ªöNG D·∫™N MI√äU T·∫¢ TRANH -->
            <div class="method-guide-card" style="margin-bottom: 30px;">
                <h2>C·∫©m nang mi√™u t·∫£ tranh Part 3 (45 gi√¢y)</h2>
                <div class="method-step">
                    <h4>Chi·∫øn l∆∞·ª£c chung</h4>
                    <p>M·ª•c ti√™u l√† mi√™u t·∫£ v√† so s√°nh 2 b·ª©c tranh trong 45 gi√¢y. H√£y ph√¢n b·ªï kho·∫£ng <strong>20 gi√¢y cho
                            m·ªói tranh</strong> v√† d√†nh 5 gi√¢y ƒë·ªÉ so s√°nh t·ªïng quan.</p>
                </div>
                <div class="method-step">
                    <h4>C·∫•u tr√∫c c√¢u m·∫´u (H·ªçc thu·ªôc l√≤ng)</h4>
                    <ul>
                        <li><strong>M·ªü ƒë·∫ßu:</strong> <code>Both pictures show...</code> (N√≥i v·ªÅ ch·ªß ƒë·ªÅ chung)</li>
                        <li><strong>Tranh 1:</strong> <code>In the first picture on the left, I can see...</code> /
                            <code>There is/are...</code></li>
                        <li><strong>Chuy·ªÉn √Ω:</strong> <code>On the contrary, in the second picture, ...</code> /
                            <code>In contrast, ...</code></li>
                        <li><strong>Tranh 2:</strong> <code>...we can see...</code> / <code>There is/are...</code></li>
                        <li><strong>So s√°nh t·ªïng th·ªÉ (N·∫øu c√≤n th·ªùi gian):</strong>
                            <code>Both pictures show different outdoor activities, but...</code></li>
                    </ul>
                </div>
                <div class="method-step">
                    <h4>V√≠ d·ª• √°p d·ª•ng (Ch·ªß ƒë·ªÅ "Locations")</h4>
                    <p><code>Both pictures show different outdoor activities.</code></p>
                    <p><code>In the first picture on the left, a couple can be seen relaxing on deck chairs at the beach. I imagine they are a couple as they are holding hands. There is a bag hanging off one deckchair and a hat hanging off the other. The weather is sunny.</code>
                    </p>
                    <p><code>On the contrary, in the second picture, we can see a group with their backpacks on their backs. They are hiking through the mountains. They look like professional athletes. It reminds me of going trekking with my friends.</code>
                    </p>
                </div>
            </div>
            <div id="topic-selector-grid" class="topic-grid">
                <!-- C√°c n√∫t ch·ªçn ch·ªß ƒë·ªÅ -->
            </div>

            <main id="speaking-container">
                <!-- Ch·ªâ m·ªôt b√†i t·∫≠p ƒë∆∞·ª£c hi·ªÉn th·ªã -->
            </main>
        </div>
        <footer id="footer-placeholder"></footer>
    </div>
    <script src="js/main.js"></script>
    <script src="js/data-speaking.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const selectorContainer = document.getElementById('topic-selector-grid');
            const contentContainer = document.getElementById('speaking-container');
            const topics = speakingData.part3;
            let timers = {}; // D√πng object ƒë·ªÉ qu·∫£n l√Ω nhi·ªÅu timer

            topics.forEach((topic, index) => {

                 // T·∫°o n√∫t ch·ªçn
                const button = document.createElement('button');
                button.className = 'topic-selector-btn';
                button.textContent = `Ch·ªß ƒë·ªÅ ${index + 1}`;
                button.dataset.target = `#${topic.id}`;

                // TH√äM LOGIC N√ÄY: Th√™m icon c·∫£nh b√°o cho ch·ªß ƒë·ªÅ ch·∫•t l∆∞·ª£ng th·∫•p
                if (topic.quality === 'low') {
                    button.innerHTML += ` <i class="fas fa-exclamation-triangle" title="Ch·ªß ƒë·ªÅ luy·ªán t·∫≠p th√™m, ·∫£nh ch·∫•t l∆∞·ª£ng th·∫•p"></i>`;
                    button.classList.add('low-quality-btn');
                }

                selectorContainer.appendChild(button);

                const card = document.createElement('div');
                card.className = 'quiz-card speaking-part3-card';
                card.id = topic.id;

                // TH√äM LOGIC N√ÄY: Th√™m m·ªôt h·ªôp c·∫£nh b√°o v√†o card
                const qualityWarning = topic.quality === 'low' 
                    ? `<div class="image-quality-warning">L∆∞u √Ω: H√¨nh ·∫£nh cho ch·ªß ƒë·ªÅ n√†y c√≥ ch·∫•t l∆∞·ª£ng th·∫•p, ch·ªâ d√πng ƒë·ªÉ tham kh·∫£o.</div>` 
                    : '';

                let tasksHTML = '';
                topic.tasks.forEach((task, i) => {
                    tasksHTML += `
                        <div class="speaking-task-container" data-task-index="${i}">
                            <p class="prompt-question"><strong>Nhi·ªám v·ª• ${i + 1}:</strong> ${task.question}</p>
                            <div class="timer-controls">
                                <button class="action-btn start-timer-btn" data-duration="${task.duration}">‚ñ∂Ô∏è B·∫Øt ƒë·∫ßu tr·∫£ l·ªùi (B·∫•m gi·ªù)</button>
                                <div class="timer-display"><span class="time-left">${task.duration}</span>s</div>
                            </div>
                        </div>
                    `;
                });

                let sampleAnswersHTML = '<h4>C√¢u tr·∫£ l·ªùi m·∫´u:</h4>';
                topic.tasks.forEach((task, i) => {
                    sampleAnswersHTML += `<div class="sample-answer"><p><strong>Nhi·ªám v·ª• ${i + 1}:</strong> ${task.sampleAnswer}</p></div>`;
                });

                card.innerHTML = `
                    <div class="card-header"><h2>${topic.title}</h2></div>
                    ${qualityWarning} 
                    <div class="part3-images">
                        <img src="${topic.image1Src}" alt="Picture 1">
                        <img src="${topic.image2Src}" alt="Picture 2">
                    </div>
                     
                    <div class="tasks-wrapper">${tasksHTML}</div>
                    <div class="card-actions">
                        <button class="action-btn show-sample-btn">üìñ Xem c√¢u tr·∫£ l·ªùi m·∫´u</button>
                    </div>
                    <div class="sample-answer-wrapper" style="display: none;">
                        <div class="audio-player-container">
                            <audio controls class="custom-audio-player" src="${topic.audioSrc}"></audio>
                        </div>
                        ${sampleAnswersHTML}
                    </div>
                `;
                contentContainer.appendChild(card);
            });

            // --- LOGIC (T√°i s·ª≠ d·ª•ng t·ª´ c√°c ph·∫ßn tr∆∞·ªõc, t√πy ch·ªânh) ---
            const allButtons = selectorContainer.querySelectorAll('.topic-selector-btn');
            const allCards = contentContainer.querySelectorAll('.speaking-part3-card');

            function showTopic(targetId) { /* ... Gi·ªëng Part 2 ... */ }
            selectorContainer.addEventListener('click', function (e) { if (e.target.classList.contains('topic-selector-btn')) showTopic(e.target.dataset.target); });
            contentContainer.addEventListener('click', function (e) {
                if (e.target.classList.contains('start-timer-btn')) { /* ... Logic timer ... */ }
                if (e.target.classList.contains('show-sample-btn')) { /* ... Logic show answer ... */ }
            });
            if (allButtons.length > 0) showTopic(allButtons[0].dataset.target);

            // --- PHI√äN B·∫¢N JAVASCRIPT ƒê·∫¶Y ƒê·ª¶ ---
            function showTopic(targetId) {
                allCards.forEach(card => card.classList.remove('active'));
                allButtons.forEach(btn => btn.classList.remove('active'));
                const targetCard = document.querySelector(targetId);
                const targetButton = selectorContainer.querySelector(`[data-target='${targetId}']`);
                if (targetCard) targetCard.classList.add('active');
                if (targetButton) targetButton.classList.add('active');

                Object.values(timers).forEach(timer => clearInterval(timer));
                allCards.forEach(c => {
                    c.querySelectorAll('.speaking-task-container').forEach(task => {
                        const btn = task.querySelector('.start-timer-btn');
                        const display = task.querySelector('.timer-display');
                        if (btn) {
                            btn.disabled = false;
                            btn.textContent = '‚ñ∂Ô∏è B·∫Øt ƒë·∫ßu tr·∫£ l·ªùi (B·∫•m gi·ªù)';
                        }
                        if (display) display.querySelector('.time-left').textContent = btn.dataset.duration;
                    });
                });
            }
            contentContainer.addEventListener('click', function (e) {
                if (e.target.classList.contains('start-timer-btn')) {
                    const button = e.target;
                    const taskContainer = button.closest('.speaking-task-container');
                    const timerId = `${taskContainer.closest('.speaking-part3-card').id}-${taskContainer.dataset.taskIndex}`;

                    if (timers[timerId]) clearInterval(timers[timerId]);

                    const timerDisplay = button.nextElementSibling;
                    const timeLeftEl = timerDisplay.querySelector('.time-left');
                    button.disabled = true;
                    button.textContent = '‚è±Ô∏è ƒêang ƒë·∫øm ng∆∞·ª£c...';
                    let timeInSeconds = parseInt(button.dataset.duration, 10);

                    timers[timerId] = setInterval(() => {
                        timeInSeconds--;
                        timeLeftEl.textContent = timeInSeconds;
                        if (timeInSeconds <= 0) {
                            clearInterval(timers[timerId]);
                            button.textContent = 'H·∫øt gi·ªù! B·∫Øt ƒë·∫ßu l·∫°i';
                            button.disabled = false;
                        }
                    }, 1000);
                }
                if (e.target.classList.contains('show-sample-btn')) {
                    const wrapper = e.target.closest('.card-actions').nextElementSibling;
                    const isVisible = wrapper.style.display === 'block';
                    wrapper.style.display = isVisible ? 'none' : 'block';
                    e.target.textContent = isVisible ? 'üìñ Xem c√¢u tr·∫£ l·ªùi m·∫´u' : 'üôà ·∫®n c√¢u tr·∫£ l·ªùi m·∫´u';
                }
            });

        });
    </script>
</body>

</html>