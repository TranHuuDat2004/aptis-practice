<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading - Part 1 Quiz</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/quiz.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" href="img/favicon.png" type="image/x-icon">
</head>

<body>
    <header id="header-placeholder"></header>
    <div class="content-pusher">
        <div class="container">
            <div class="page-intro">
                <h1>Reading - Part 1 Quiz</h1>
                <p>Ch·ªçn t·ª´ ƒë√∫ng ƒë·ªÉ ƒëi·ªÅn v√†o ch·ªó tr·ªëng trong m·ªói c√¢u.</p>
            </div>
            <div class="explanation-box">
                <h3>üí° Ph∆∞∆°ng ph√°p l√†m b√†i</h3>
                <p>M·ªói b·ªô 5 c√¢u h·ªèi s·∫Ω ƒëi·ªÅn 5 t·ª´ cho s·∫µn. H√£y ƒë·ªçc k·ªπ ng·ªØ c·∫£nh c·ªßa t·ª´ng c√¢u ƒë·ªÉ ch·ªçn ra ƒë√°p √°n ph√π h·ª£p
                    nh·∫•t. Ch√∫ √Ω ƒë·∫øn lo·∫°i t·ª´ (danh t·ª´, ƒë·ªông t·ª´, t√≠nh t·ª´) v√† √Ω nghƒ©a c·ªßa c√¢u.</p>
            </div>
            <main id="quiz-container">
                <!-- N·ªôi dung c√°c b·ªô c√¢u h·ªèi s·∫Ω ƒë∆∞·ª£c JS ch√®n v√†o ƒë√¢y -->
            </main>
            <div class="pagination-controls" id="pagination-controls">
                <!-- N√∫t ph√¢n trang s·∫Ω ƒë∆∞·ª£c JS ch√®n v√†o ƒë√¢y -->
            </div>
            <div class="card-actions" style="justify-content: center; margin-top: 20px;">
                <button class="action-btn check-answer-btn" id="check-answers-btn">Ki·ªÉm tra ƒë√°p √°n</button>
            </div>
            <div id="result-message" class="feedback-message" style="text-align: center; margin-top: 20px;"></div>
        </div>
        <footer id="footer-placeholder"></footer>
    </div>

    <script src="js/data-reading-part1.js"></script> <!-- S·ª¨ D·ª§NG FILE DATA M·ªöI -->
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const quizContainer = document.getElementById('quiz-container');
            const paginationControls = document.getElementById('pagination-controls');
            const checkAnswersBtn = document.getElementById('check-answers-btn');
            const resultMessage = document.getElementById('result-message');

            const topics = readingPart1Data; // L·∫•y d·ªØ li·ªáu t·ª´ file m·ªõi
            const topicsPerPage = 1; // M·ªói trang hi·ªÉn th·ªã 1 b·ªô 5 c√¢u
            let currentPage = 1;

            function renderPage(page) {
                quizContainer.innerHTML = '';
                currentPage = page;
                const topicIndex = page - 1;
                const topic = topics[topicIndex];

                if (!topic) return;

                const quizCard = document.createElement('div');
                quizCard.className = 'quiz-card part1-quiz';
                quizCard.dataset.topicIndex = topicIndex;

                let questionsHTML = '';
                topic.questions.forEach((q, qIndex) => {
                    let optionsHTML = '';
                    q.options.forEach(option => {
                        optionsHTML += `
                            <label class="radio-label">
                                <input type="radio" name="topic-${topicIndex}-q-${qIndex}" value="${option}">
                                <span>${option}</span>
                            </label>
                        `;
                    });

                    questionsHTML += `
                        <div class="part1-question-item" data-question-index="${qIndex}">
                            <p class="question-text">${q.text.replace('___', '<strong>___</strong>')}</p>
                            <div class="options-container">${optionsHTML}</div>
                            <div class="feedback-answer" style="display: none;"></div>
                        </div>
                    `;
                });

                quizCard.innerHTML = `
                    <h2 class="part1-topic-title">${topic.title}</h2>
                    ${questionsHTML}
                `;
                quizContainer.appendChild(quizCard);
                renderPagination();
                resultMessage.textContent = '';
            }

            function renderPagination() {
                paginationControls.innerHTML = '';
                const pageCount = topics.length;
                for (let i = 1; i <= pageCount; i++) {
                    const button = document.createElement('button');
                    button.textContent = i;
                    button.className = (i === currentPage) ? 'active' : '';
                    button.addEventListener('click', () => renderPage(i));
                    paginationControls.appendChild(button);
                }
            }

            checkAnswersBtn.addEventListener('click', function () {
                const currentCard = quizContainer.querySelector('.part1-quiz');
                if (!currentCard) return;

                const topicIndex = parseInt(currentCard.dataset.topicIndex);
                const topicData = topics[topicIndex];
                const questionItems = currentCard.querySelectorAll('.part1-question-item');
                let correctCount = 0;

                questionItems.forEach(item => {
                    const qIndex = parseInt(item.dataset.questionIndex);
                    const questionData = topicData.questions[qIndex];
                    const selectedRadio = item.querySelector(`input[name="topic-${topicIndex}-q-${qIndex}"]:checked`);
                    const feedbackDiv = item.querySelector('.feedback-answer');

                    item.classList.remove('correct', 'incorrect');
                    feedbackDiv.style.display = 'block';

                    if (selectedRadio) {
                        if (selectedRadio.value === questionData.answer) {
                            item.classList.add('correct');
                            feedbackDiv.textContent = 'Ch√≠nh x√°c!';
                            correctCount++;
                        } else {
                            item.classList.add('incorrect');
                            feedbackDiv.innerHTML = `Sai r·ªìi! ƒê√°p √°n ƒë√∫ng l√†: <strong>${questionData.answer}</strong>`;
                        }
                    } else {
                        item.classList.add('incorrect');
                        feedbackDiv.innerHTML = `B·∫°n ch∆∞a ch·ªçn ƒë√°p √°n. ƒê√°p √°n ƒë√∫ng l√†: <strong>${questionData.answer}</strong>`;
                    }
                });

                resultMessage.innerHTML = `B·∫°n ƒë√£ tr·∫£ l·ªùi ƒë√∫ng <strong>${correctCount}/${questionItems.length}</strong> c√¢u.`;
            });

            renderPage(1);
        });
    </script>
</body>

</html>